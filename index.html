<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Nikaara Jewellers | Diamond Jewellery Calculator</title>

<style>
:root{
    --bg:#eef7f4;
    --card:#ffffff;
    --border:#e3e3e3;
    --gold:#c9a24d;
    --dark:#252216;
    --accent:#0a7d55;
}
*{box-sizing:border-box}

body{
    margin:0;
    font-family:'Segoe UI','Inter',sans-serif;
    background:var(--bg);
    min-height:100vh;
    display:flex;
    justify-content:center;
    align-items:center;
}

.container{
    max-width:620px;
    width:100%;
    background:var(--card);
    padding:28px;
    border-radius:18px;
    box-shadow:0 20px 50px rgba(0,0,0,.12);
}

.logo{display:block;margin:0 auto 12px;max-width:150px}
h2{text-align:center;margin-bottom:24px}

/* Sections */
.section{margin-top:26px}
.section-title{
    display:flex;align-items:center;gap:8px;
    font-size:14px;font-weight:600;margin-bottom:14px
}
.section-title::before{
    content:"";width:4px;height:16px;background:var(--gold)
}

/* Inputs */
label{font-size:13px;margin-bottom:4px;display:block}
input,select{
    width:100%;padding:11px;border-radius:8px;
    border:1px solid var(--border);background:#fbfbfb
}

/* Toggle */
.toggle{
    display:flex;border:1px solid var(--border);
    border-radius:10px;overflow:hidden
}
.toggle button{
    flex:1;padding:10px;border:none;
    cursor:pointer;background:#eee;font-weight:600
}
.toggle button.active{background:var(--dark);color:#fff}

/* Stones */
.stones-wrapper{
    background:#f7f7f7;border:1px solid var(--border);
    border-radius:14px;padding:14px
}
.stone-row{
    display:grid;
    grid-template-columns:1.4fr 1fr 1fr auto;
    gap:8px;margin-bottom:10px
}
.add-stone-btn{
    width:100%;padding:10px;border:none;
    border-radius:10px;background:#e0e0e0;
    font-weight:600;margin-bottom:12px;cursor:pointer
}
.delete-btn{
    background:#ffdede;border:none;
    border-radius:8px;padding:6px 8px;
    cursor:pointer
}

/* Buttons */
.actions{margin-top:28px;display:flex;flex-direction:column;gap:12px}
button.action{
    width:100%;padding:14px;border:none;
    border-radius:12px;font-size:14px;
    font-weight:600;cursor:pointer
}
.btn-estimate{background:var(--dark);color:#fff}
.btn-discount{background:var(--gold);color:#fff}

/* Result */
.result{margin-top:30px}
.box{
    background:#fafafa;border:1px solid var(--border);
    border-radius:14px;padding:14px;margin-bottom:14px
}
.box h4{margin:0 0 8px;font-size:14px}
.box p{
    margin:4px 0;display:flex;
    justify-content:space-between;font-size:13px
}
.summary{
    background:#f1f6f4;border-radius:16px;padding:16px
}
.final{font-size:20px;font-weight:700}
.saved{color:var(--accent);font-weight:600;margin-top:6px}
.note{text-align:center;font-size:11px;color:#777;margin-top:14px}
</style>
</head>

<body>
<div class="container">

<img src="nikaara-logo.png" class="logo">
<h2>Diamond Jewellery Calculator</h2>

<!-- GOLD -->
<div class="section">
<div class="section-title">Gold Details</div>

<label>Gold Karat</label>
<select id="goldKarat">
    <option>9K</option><option>14K</option>
    <option>18K</option><option>22K</option>
</select>

<label>Gross Weight (grams)</label>
<input id="grossWt" type="number" step="0.001">

<label>Gold Price (per gram)</label>
<input id="goldRate" type="number">
</div>

<!-- DIAMOND -->
<div class="section">
<div class="section-title">Diamond Details</div>

<label>Diamond Type</label>
<div class="toggle">
    <button id="naturalBtn" class="active" onclick="setDiamondType('Natural')">Natural</button>
    <button id="cvdBtn" onclick="setDiamondType('Lab-Grown (CVD)')">Lab-Grown (CVD)</button>
</div>

<label>Main Diamond Weight (ct)</label>
<input id="diamondCt" type="number" step="0.01">

<label>Main Diamond Price (₹ / ct)</label>
<input id="diamondRate" type="number">
</div>

<!-- ADDITIONAL STONES (ALWAYS VISIBLE) -->
<div class="section">
<div class="section-title">Additional Stones</div>

<div class="stones-wrapper">
    <button class="add-stone-btn" onclick="addStone()">+ Add Stone</button>
    <div id="stoneList"></div>
</div>
</div>

<!-- ACTIONS -->
<div class="actions">
<button class="action btn-estimate" onclick="calculate()">Get Estimation</button>
<button class="action btn-discount" onclick="calculateDiscount()">Get With Discount</button>
</div>

<div class="result" id="output"></div>
<div class="note">*All prices are estimates | GST @ 3%</div>

</div>

<script>
const GST = 0.03;
let diamondType = "Natural";

const inr = n =>
  "₹" + n.toLocaleString("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2});

function setDiamondType(t){
    diamondType=t;
    naturalBtn.classList.toggle("active",t==="Natural");
    cvdBtn.classList.toggle("active",t!=="Natural");
}

function addStone(){
    const row=document.createElement("div");
    row.className="stone-row";
    row.innerHTML=`
        <select class="stoneType">
            <option value="diamond">Diamond (${diamondType})</option>
            <option value="other">Other Stone</option>
        </select>
        <input class="stoneCt" type="number" step="0.01" placeholder="Ct">
        <input class="stoneRate" type="number" placeholder="₹ / ct">
        <button class="delete-btn" onclick="this.parentElement.remove()">✖</button>
    `;
    stoneList.appendChild(row);
}

function collectStones(){
    let diamonds=[], otherValue=0, stoneGrams=0;

    document.querySelectorAll(".stone-row").forEach(()=>{
        const type=event.target?.closest('.stone-row')?.querySelector('.stoneType')?.value;
    });

    document.querySelectorAll(".stone-row").forEach((r)=>{
        const type=r.querySelector(".stoneType").value;
        const ct=parseFloat(r.querySelector(".stoneCt").value);
        const rate=parseFloat(r.querySelector(".stoneRate").value);
        if(!isNaN(ct)&&!isNaN(rate)){
            const value=ct*rate;
            stoneGrams+=ct*0.2;
            if(type==="diamond"){
                diamonds.push({label:`Diamond Stone ${diamonds.length+1}`,value});
            }else{
                otherValue+=value;
            }
        }
    });

    return {diamonds,otherValue,stoneGrams};
}

function core(applyDiscount){
    const gross = parseFloat(document.getElementById("grossWt").value);
    const goldRateVal = parseFloat(document.getElementById("goldRate").value);
    const dCt = parseFloat(document.getElementById("diamondCt").value);
    const dRate = parseFloat(document.getElementById("diamondRate").value);

    if([gross, goldRateVal, dCt, dRate].some(isNaN)) return null;

    const mainDiamondValue = dCt * dRate;
    const mainDiamondGrams = dCt * 0.2;

    const stones = collectStones();
    const netGold = gross - mainDiamondGrams - stones.stoneGrams;
    if(netGold <= 0) return null;

    const goldValue = netGold * goldRateVal;
    const making = netGold * 1799;

    const diamondList = [
        { label: `Main Diamond (${diamondType})`, value: mainDiamondValue },
        ...stones.diamonds
    ];

    const totalDiamond = diamondList.reduce((s, d) => s + d.value, 0);
    const diamondDisc = applyDiscount ? totalDiamond * 0.11 : 0;
    const makingDisc = applyDiscount ? making * 0.16 : 0;

    const beforeGST =
        goldValue +
        (totalDiamond - diamondDisc) +
        (making - makingDisc) +
        stones.otherValue;

    const gst = beforeGST * GST;

    return {
        goldValue,
        diamondList,
        totalDiamond,
        diamondDisc,
        making,
        makingDisc,
        stones,
        beforeGST,
        gst,
        netGold
    };
}

function render(result,discount){
    let diamondHTML=result.diamondList.map(d=>
        `<p><span>${d.label}</span><span>${inr(d.value)}</span></p>`
    ).join("");

    output.innerHTML=`
    <div class="box">
        <h4>Gold Value</h4>
        <p><span>Gold</span><span>${inr(result.goldValue)}</span></p>
    </div>

    <div class="box">
        <h4>Diamond Details (${diamondType})</h4>
        ${diamondHTML}
        <hr>
        <p><b>Total Diamond</b><b>${inr(result.totalDiamond)}</b></p>
        ${discount?`<p>Discount (11%): -${inr(result.diamondDisc)}</p>`:""}
    </div>

    <div class="box">
        <h4>Making Charges</h4>
        <p><span>Original</span><span>${inr(result.making)}</span></p>
        ${discount?`<p>Discount (16%): -${inr(result.makingDisc)}</p>`:""}
    </div>

    <div class="box">
        <h4>Other Stones</h4>
        ${inr(result.stones.otherValue)}
    </div>

    <div class="summary">
        <p><span>Total Before GST</span><span>${inr(result.beforeGST)}</span></p>
        <p><span>GST (3%)</span><span>${inr(result.gst)}</span></p>
        <hr>
        <p class="final">Final Price: ${inr(result.beforeGST+result.gst)}</p>
        ${discount?`<p class="saved">You Saved ${inr(result.diamondDisc+result.makingDisc)}</p>`:""}
        <p>Net Gold Weight: ${result.netGold.toFixed(3)} g</p>
    </div>`;
}

function calculate(){
    const r=core(false);
    if(!r) return alert("Check inputs");
    render(r,false);
}

function calculateDiscount(){
    const r=core(true);
    if(!r) return alert("Check inputs");
    render(r,true);
}
</script>
</body>
</html>
